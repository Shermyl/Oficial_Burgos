<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu - Burgos's</title>
    <link rel="stylesheet" href="css/menu.css">
    <link rel="icon" href="Img/logo.svg">
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;700&family=Playwrite+HR+Lijeva:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header consistente con el sitio principal -->
    <header class="menu-header">
        <div class="header-content">
            <div class="logo">
                <img src="Img/logo.svg" alt="Burgos's Restaurant Logo">
            </div>
            <h1>Nuestro Men√∫</h1>
            <p class="subtitle">Sabores aut√©nticos de Burgos</p>
        </div>
    </header>

    <main class="menu-container">
        <!-- Filtros mejorados -->
        <div class="filters-container">
            <div class="filters">
                <button class="filter-btn active" data-filter="all">Todo</button>
                <button class="filter-btn" data-filter="entradas">Entradas</button>
                <button class="filter-btn" data-filter="platos-fuertes">Platos Fuertes</button>
                <button class="filter-btn" data-filter="bebidas">Bebidas</button>
                <button class="filter-btn" data-filter="postres">Postres</button>
            </div>
            <div class="search-box">
                <input type="text" placeholder="Buscar platillo..." class="search-input">
                <button class="search-btn">üîç</button>
            </div>
        </div>

        <!-- Secci√≥n de categor√≠as -->
        <section class="category-section" id="entradas">
            <h2 class="category-title">üçΩÔ∏è Entradas</h2>
            <div class="menu-grid">
                <!-- Ejemplo de tarjeta mejorada -->
                <div class="menu-card" data-category="entradas">
                    <div class="card-badge">Recomendado</div>
                    <img src="Img/menu/Cecina.png" alt="Cecina" class="menu-img">
                    <div class="menu-info">
                        <div class="title-wrapper">
                            <h3 class="menu-title">Cecina</h3>
                            <span class="menu-price">$10.00</span>
                        </div>
                        <p class="menu-description">Deliciosa carne seca t√≠pica de la regi√≥n, acompa√±ada de yuca y salsa criolla.</p>
                        <div class="menu-footer">
                            <span class="menu-category">Entrada</span>
                            <button class="add-to-cart">+ A√±adir</button>
                        </div>
                    </div>
                </div>
                
                <!-- M√°s tarjetas de entradas... -->
            </div>
        </section>

        <section class="category-section" id="platos-fuertes">
            <h2 class="category-title">üçõ Platos Fuertes</h2>
            <div class="menu-grid">
                <!-- Ejemplo de plato fuerte -->
                <div class="menu-card" data-category="platos-fuertes">
                    <img src="Img/menu/Estofado de gallina.png" alt="Estofado de gallina" class="menu-img">
                    <div class="menu-info">
                        <div class="title-wrapper">
                            <h3 class="menu-title">Estofado de Gallina</h3>
                            <span class="menu-price">$14.50</span>
                        </div>
                        <p class="menu-description">Gallina criolla cocinada a fuego lento con especias tradicionales y acompa√±ada de arroz.</p>
                        <div class="menu-footer">
                            <span class="menu-category">Plato Principal</span>
                            <button class="add-to-cart">+ A√±adir</button>
                        </div>
                    </div>
                </div>
                
                <!-- M√°s platos fuertes... -->
            </div>
        </section>

        <!-- Otras categor√≠as... -->
    </main>

    <!-- Carrito flotante -->
    <div class="floating-cart">
        <span class="cart-count">0</span>
        <img src="Img/shopping-cart.png" alt="Carrito de compras">
    </div>

    <!--Sistema de pedidos - parte CLIENTE-->
        <div id="cart-container">
        <h3>Tu Pedido</h3>
        <ul id="cart-items"></ul>
        <p>Total: S/ <span id="cart-total">0.00</span></p>
        
        <form id="checkout-form">
            <input type="text" id="customer-name" placeholder="Nombre completo" required>
            <input type="tel" id="customer-phone" placeholder="Tel√©fono" required>
            <textarea id="delivery-address" placeholder="Direcci√≥n de entrega" required></textarea>
            
            <select id="payment-method">
            <option value="cash">Efectivo</option>
            <option value="yape">Yape</option>
            </select>
            
            <div id="yape-qr-container" style="display:none;">
            <p>Escanea este c√≥digo para pagar:</p>
            <div id="yape-qr"></div>
            </div>
            
            <button type="submit">Confirmar Pedido</button>
        </form>
        </div>

        <script type="module">
        import { placeOrder } from './js/database.js';
        import QRCode from 'https://esm.sh/qrcode.react';
        
        // Manejo del carrito
        let cart = [];
        
        // Funci√≥n para actualizar el carrito en la UI
        function updateCartUI() {
            const cartItemsEl = document.getElementById('cart-items');
            const cartTotalEl = document.getElementById('cart-total');
            
            cartItemsEl.innerHTML = '';
            let total = 0;
            
            cart.forEach(item => {
            const li = document.createElement('li');
            li.textContent = `${item.quantity}x ${item.name} - S/ ${(item.price * item.quantity).toFixed(2)}`;
            cartItemsEl.appendChild(li);
            total += item.price * item.quantity;
            });
            
            cartTotalEl.textContent = total.toFixed(2);
        }
        
        // Manejo del formulario de pedido
        document.getElementById('checkout-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const orderData = {
            customer_name: document.getElementById('customer-name').value,
            phone: document.getElementById('customer-phone').value,
            address: document.getElementById('delivery-address').value,
            payment_method: document.getElementById('payment-method').value,
            items: cart,
            total: parseFloat(document.getElementById('cart-total').textContent),
            status: 'pending'
            };
            
            try {
            const order = await placeOrder(orderData);
            alert(`Pedido #${order.id} realizado con √©xito!`);
            cart = [];
            updateCartUI();
            } catch (error) {
            alert('Error al realizar el pedido: ' + error.message);
            }
        });
        
        // Mostrar/ocultar QR de Yape
        document.getElementById('payment-method').addEventListener('change', (e) => {
            const yapeContainer = document.getElementById('yape-qr-container');
            if (e.target.value === 'yape') {
            yapeContainer.style.display = 'block';
            // Generar QR din√°mico con el monto
            const total = document.getElementById('cart-total').textContent;
            ReactDOM.render(
                React.createElement(QRCode, {
                value: `yape://payment?phone=999888777&amount=${total}&note=BurgosOrder`,
                size: 128
                }),
                document.getElementById('yape-qr')
            );
            } else {
            yapeContainer.style.display = 'none';
            }
        });
        </script>
    <!--aqui termina el sistema pedido_cliente-->

    <script src="js/menu.js"></script>

    <script type="module">
    import { placeOrder } from './js/database.js' // Ruta relativa correcta
    // Usa placeOrder donde lo necesites
    </script>
</body>
</html>

